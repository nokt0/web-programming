!function(e){function t(t){for(var a,c,o=t[0],d=t[1],s=t[2],l=0,p=[];l<o.length;l++)c=o[l],Object.prototype.hasOwnProperty.call(r,c)&&r[c]&&p.push(r[c][0]),r[c]=0;for(a in d)Object.prototype.hasOwnProperty.call(d,a)&&(e[a]=d[a]);for(u&&u(t);p.length;)p.shift()();return i.push.apply(i,s||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],a=!0,o=1;o<n.length;o++){var d=n[o];0!==r[d]&&(a=!1)}a&&(i.splice(t--,1),e=c(c.s=n[0]))}return e}var a={},r={0:0},i=[];function c(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=a,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)c.d(n,a,function(t){return e[t]}.bind(null,a));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/";var o=window.webpackJsonp=window.webpackJsonp||[],d=o.push.bind(o);o.push=t,o=o.slice();for(var s=0;s<o.length;s++)t(o[s]);var u=d;i.push([51,1]),n()}([,,,,,function(e,t,n){var a=n(2),r=n(22);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};a(r,i);e.exports=r.locals||{}},function(e,t){e.exports='<div class="update-button"> <button id="update-geolocation-button" class="update-button__button"> <span class="update-button__button-text">Обновить геолокацию</span> <img class="update-button__button-icon" src="./assets/img/update-arrows.svg" alt="update icon"/> </button> </div> '},function(e,t){e.exports='<div id="weather-main-container" class="weather-main"> <div class="weather-main__city"><h2 id="weather-main-city"></h2></div> <div id="weather-main-icon" class="weather-main__icon"> </div> <div id="weather-main-degree" class="weather-main__degree"></div> </div> '},,,function(e,t){e.exports='<div class="add-city"> <div class="add-city__header"> <h3>Избранное</h3> </div> <div id="add-city-input-container" class="add-city__input"> <form> <input name="city" placeholder="Добавить новый город" type="text"> </form> </div> </div> '},function(e,t){e.exports='<div class="favorite-cities"> <div id="favorite-cities-add" class="favorite-cities__add"></div> <div id="favorite-cities-cities" class="favorite-cities__cities"></div> </div> '},function(e,t){e.exports='<div id="header-menu-container" class="header-menu"> <div class="header-menu__top" id="header-menu-top"> <div class="header-menu__top-title"><h1>Погода здесь</h1></div> </div> <div id="header-menu-weather" class="header-menu-weather"> <div class="header-menu-weather__main" id="header-menu-weather-main"></div> <div class="header-menu-weather__detailed" id="header-menu-weather-detailed"></div> </div> </div> '},function(e,t){e.exports='<main class="app"> <div class="app-container"> <header class="app-header" id="app-header"></header> <div class="app-body" id="app-body"></div> </div> </main> '},,,function(e,t){e.exports='<div id="city-card" class="city-card"> <div id="city-card-header" class="city-card__header"></div> <div id="city-card-data" class="city-card__data"></div> </div> '},function(e,t){e.exports='<div id="city-card-header" class="city-card-header"> <div class="city-card-header__first-part"> <div id="city-card-header-city" class="city-card-header__header"></div> <div id="city-card-header-degree" class="city-card-header__degree"></div> <div id="city-card-header-icon" class="city-card-header__icon"></div> </div> <div class="city-card-header__second-part"> <div id="city-card-header-close" class="city-card-header__close"></div> </div> </div> '},function(e,t){e.exports='<div> <button class="round-button"></button> </div> '},function(e,t){e.exports='<div id="card-loading" class="card-loading"> <div><p>Подождите, данные загружаются</p></div> <div id="card-loading-icon-container" class="card-loading__icon"></div> </div> '},,,function(e,t,n){},function(e,t,n){var a=n(2),r=n(24);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};a(r,i);e.exports=r.locals||{}},function(e,t,n){},function(e,t,n){var a=n(2),r=n(26);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};a(r,i);e.exports=r.locals||{}},function(e,t,n){},function(e,t,n){var a=n(2),r=n(28);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};a(r,i);e.exports=r.locals||{}},function(e,t,n){},,,,function(e,t,n){var a=n(2),r=n(33);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};a(r,i);e.exports=r.locals||{}},function(e,t,n){},function(e,t,n){var a=n(2),r=n(35);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};a(r,i);e.exports=r.locals||{}},function(e,t,n){},function(e,t,n){var a=n(2),r=n(37);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};a(r,i);e.exports=r.locals||{}},function(e,t,n){},,,,function(e,t,n){var a=n(2),r=n(42);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};a(r,i);e.exports=r.locals||{}},function(e,t,n){},function(e,t,n){var a=n(2),r=n(44);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};a(r,i);e.exports=r.locals||{}},function(e,t,n){},function(e,t,n){var a=n(2),r=n(46);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};a(r,i);e.exports=r.locals||{}},function(e,t,n){},function(e,t,n){var a=n(2),r=n(48);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};a(r,i);e.exports=r.locals||{}},function(e,t,n){},function(e,t,n){var a=n(2),r=n(50);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};a(r,i);e.exports=r.locals||{}},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a,r=n(3),i=n.n(r),c=n(0),o=n.n(c),d=n(14),s=n.n(d),u=(n(5),n(23),n(6)),l=n.n(u),p=(n(25),n(1)),v=n.n(p),h="Update",f="Clouds",m="Drizzle",g="Snow",y="Thunderstorm",w="Rain",_="Clear",x="Tornado",b="Mist",E="Smoke",I="Haze",T="Dust",C="Fog",M="Sand",B="Ash",k="Squall",O="./assets/img/017-foog.svg",S=(a={},v()(a,h,"./assets/img/update-arrows.svg"),v()(a,f,"./assets/img/001-cloud.svg"),v()(a,m,"./assets/img/003-rainy.svg"),v()(a,y,"./assets/img/036-storm-4.svg"),v()(a,g,"./assets/img/012-snowy-1.svg"),v()(a,w,"./assets/img/004-rainy-1.svg"),v()(a,_,"./assets/img/039-sun.svg"),v()(a,x,"./assets/img/046-tornado.svg"),v()(a,b,O),v()(a,E,O),v()(a,I,O),v()(a,T,O),v()(a,C,O),v()(a,M,O),v()(a,B,O),v()(a,k,O),a);function j(e,t){var n=S[t];if(!n)return null;var a=document.createElement("div");a.id="weather-icon-container-".concat(e),a.classList.add("weather-icon__container");var r=document.createElement("img");return r.id="weather-icon-".concat(e),r.classList.add("weather-icon__icon"),r.src=n,a.appendChild(r),a}var L=n(7),P=n.n(L);n(27);function D(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=document.createElement("ul");return 0!==t.length&&e?(n.id="".concat("weather-detailed","-").concat(e),n.classList.add("weather-detailed"),t.forEach((function(e){var t=e.title,a=e.value,r=document.createElement("li"),i=document.createElement("span"),c=document.createElement("span");r.classList.add("weather-detailed__item"),i.classList.add("weather-detailed__title"),i.innerText=t,c.innerText=a,r.appendChild(i),r.appendChild(c),n.appendChild(r)})),n):null}var J=navigator.geolocation;function N(){return new Promise((function(e,t){J.getCurrentPosition((function(t){var n=t.coords,a=n.latitude,r=n.longitude;e({latitude:a,longitude:r})}),(function(e){console.error(e),t(e)}),{enableHighAccuracy:!0})}))}function F(e,t){return fetch("".concat("https://weather-app-222.herokuapp.com","/weather/coordinates?lat=").concat(e,"&lon=").concat(t)).then((function(e){return e.json()})).catch((function(e){console.log(e),alert("Ошибка во время выполнения запроса ".concat(e))}))}function H(e){return z.apply(this,arguments)}function z(){return(z=i()(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch("".concat("https://weather-app-222.herokuapp.com","/weather/city?name=").concat(decodeURI(t))).then((function(e){return e.json()})).catch((function(e){console.log(e),alert("Ошибка во время выполнения запроса ".concat(e))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(){return q.apply(this,arguments)}function q(){return(q=i()(o.a.mark((function e(){var t,n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N();case 3:a=e.sent,t=a.latitude,n=a.longitude,e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(0),new Error("Cant get geolocation");case 11:return e.next=13,F(t,n);case 13:return e.abrupt("return",e.sent);case 14:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}var R=n(15),U=n.n(R);function G(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.data,n=t.coord,a=t.name,r=t.main,i=(r=void 0===r?{}:r).temp,c=r.humidity,o=r.pressure,d=t.clouds,s=(d=void 0===d?{}:d).all,u=t.wind,l=t.weather,p="[".concat(n.lat.toFixed(2),", ").concat(n.lon.toFixed(2),"]"),v="".concat(s,"%"),h="".concat(u.speed," m/s, ").concat(u.deg),f="".concat(o," hpa"),m="".concat(c,"%"),g=U()(l,1),y=g[0].main,w=Math.floor(i),_=[{title:"Ветер",value:h},{title:"Облачность",value:v},{title:"Давление",value:f},{title:"Влажность",value:m},{title:"Координаты",value:p}];return{weatherDetails:_,city:a,degree:w,weatherType:y}}n(32);var K=n(16),Q=n.n(K),V=(n(34),n(17)),W=n.n(V),X=n(18),Y=n.n(X);n(36);function Z(e){var t=(new DOMParser).parseFromString(Y.a,"text/html"),n=null==t?void 0:t.getElementsByTagName("button")[0];return n.innerText=e,n}var $=n(4),ee=n.n($),te=window.localStorage;function ne(){te.setItem("app-cities-data",JSON.stringify([]))}function ae(){return JSON.parse(te.getItem("app-cities-data"))||ne(),JSON.parse(te.getItem("app-cities-data"))}function re(e){te.setItem("app-cities-data",JSON.stringify(e))}function ie(e){if(e){var t=ae();if(t.includes(e))throw Error("Город уже добавлен в избранное");t.push(e),re(t),window.dispatchEvent(new Event("storageChanged"))}}function ce(e){var t=ae();te.setItem("app-cities-data",JSON.stringify([].concat(ee()(t),ee()(e))))}function oe(e){e&&(re(ae().filter((function(t){return t!==e}))),window.dispatchEvent(new Event("storageChanged")))}function de(e){return fetch("".concat("https://weather-app-222.herokuapp.com","/favorite"),{method:"POST",body:JSON.stringify({name:e}),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()}))}function se(e){return fetch("".concat("https://weather-app-222.herokuapp.com","/favorite"),{method:"DELETE",body:JSON.stringify({name:e}),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()}))}var ue="".concat("city-card-header","-city"),le="".concat("city-card-header","-degree"),pe="".concat("city-card-header","-icon"),ve="".concat("city-card-header","-close");n(41);var he=n(19),fe=n.n(he);function me(e,t){var n=t.isLoading,a=t.weatherDetails,r=t.weatherType,c=t.city,d=t.degree;if(!e)return null;var s=(new DOMParser).parseFromString(Q.a,"text/html"),u=s.getElementById("city-card"),l=s.getElementById("city-card-data");if(u.id+="-".concat(e),l.id+="-".concat(e),n){var p=function(e){var t=(new DOMParser).parseFromString(fe.a,"text/html"),n=null==t?void 0:t.getElementById("card-loading"),a=null==t?void 0:t.getElementById("card-loading-icon-container");n.id="".concat("card-loading","-").concat(e),a.id="".concat("card-loading-icon-container","-").concat(e);var r=j("card-loading-".concat(e),h);return a.appendChild(r),n}(e);l.appendChild(p)}else{var v=D(e,a);l.appendChild(v)}var f=s.getElementById("city-card-header"),m=function(e,t){var n=t.weatherType,a=t.city,r=t.degree,c=(new DOMParser).parseFromString(W.a,"text/html"),d=c.getElementById("city-card-header"),s=c.getElementById(ue),u=c.getElementById(le),l=c.getElementById(pe),p=c.getElementById(ve),v=j(e,n);v&&l.appendChild(v);var h=Z("✕"),f="".concat(e).replace("city-card-","");return f&&(h.onclick=i()(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,se(f);case 2:oe(f);case 3:case"end":return e.stop()}}),e)})))),p.appendChild(h),a&&(s.innerText=a),r&&(u.innerText="".concat(r,"°C")),d.id="".concat("city-card-header","-").concat(e),s.id="".concat(ue,"-").concat(e),u.id="".concat(le,"-").concat(e),l.id="".concat(pe,"-").concat(e),p.id="".concat(ve,"-").concat(e),d}(e,{weatherType:r,city:c,degree:d});return f.appendChild(m),u}n(43),n(45);var ge=n(10),ye=n.n(ge);var we=n(11),_e=n.n(we);function xe(){document.getElementById("favorite-cities-add").innerHTML=ye.a,function(){var e=document.getElementById("add-city-input-container").querySelector("form");e.onsubmit=be;var t=Z("+");t.type="submit",e.appendChild(t)}()}function be(e){return Ee.apply(this,arguments)}function Ee(){return(Ee=i()(o.a.mark((function e(t){var n,a,r,i,c,d;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),a=new FormData(t.target),!(r=a.get("city"))){e.next=21;break}return e.prev=4,e.next=7,de(r);case 7:if("city not found"!==(null==(c=e.sent)?void 0:c.message)){e.next=10;break}throw new Error("Город с таким названием не найден");case 10:if(!(null==c||null===(i=c.message)||void 0===i?void 0:i.includes("already exists"))){e.next=12;break}throw new Error("Город уже добавлен");case 12:if(!(null==c?void 0:c.data)){e.next=16;break}return e.next=15,Me(c);case 15:ie(null===(d=c.data)||void 0===d?void 0:d.name);case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(4),alert(e.t0.message||"Город уже добавлен в избранное");case 21:null==t||null===(n=t.target)||void 0===n||n.reset();case 22:case"end":return e.stop()}}),e,null,[[4,18]])})))).apply(this,arguments)}function Ie(){Le({weatherType:h,city:"Подождите, данные загружаются"})}function Te(e){return Ce.apply(this,arguments)}function Ce(){return(Ce=i()(o.a.mark((function e(t){var n,a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,Ie(),e.next=4,A();case 4:(n=e.sent)&&(a=G(n),setTimeout((function(){return Le(a)}),500)),e.next=17;break;case 8:if(e.prev=8,e.t0=e.catch(0),console.log(e.t0),alert("Пожалуйста, разрешите доступ к геолокации"),!t){e.next=17;break}return e.next=15,H(t);case 15:(n=e.sent)&&(r=G(n),setTimeout((function(){return Le(r)}),500));case 17:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function Me(e){return Be.apply(this,arguments)}function Be(){return(Be=i()(o.a.mark((function e(t){var n,a,r,i,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=document.getElementById("favorite-cities-cities"),a=G(t),r=a.city,i=me(r,{isLoading:!0,city:r}),n.appendChild(i);try{c=me(r,a),n.removeChild(i),n.appendChild(c)}catch(e){console.log(e),alert("Произошла ошибка при добавлении города."),n.removeChild(i)}case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ke(){var e=ae(),t=document.getElementById("favorite-cities-cities");t.childNodes.forEach((function(n){if(n.id){var a="".concat(n.id).replace("city-card-","");e.includes(a)||t.removeChild(n)}})),e.forEach((function(e){document.getElementById("city-card-".concat(e))||H(e).then((function(e){return e&&Me(e)}))}))}function Oe(){ke()}var Se=n(12),je=n.n(Se);function Le(e){var t=e.weatherDetails,n=s()(e,["weatherDetails"]),a=document.getElementById("update-geolocation-button"),r=document.getElementById("header-menu-top");a&&(r.insertAdjacentHTML("beforeend",l.a),a.onclick=Te),document.getElementById("header-menu-weather-main").innerHTML=P.a,function(e){var t=e.weatherType,n=e.degree,a=e.city,r=void 0===a?"":a,i=document.getElementById("weather-main-container"),c=document.getElementById("weather-main-icon"),o=document.getElementById("weather-main-degree"),d=document.getElementById("weather-main-city");t===h&&i.classList.add("updating");var s=j("header-menu",t);s&&c.appendChild(s),o.innerText=n&&"".concat(n,"°")||"",d.innerText=r}(n);var i=D("header-menu",t);i&&document.getElementById("header-menu-weather-detailed").replaceChildren(i)}n(47);var Pe=n(13),De=n.n(Pe);window.onload=i()(o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.getElementById("root").innerHTML=De.a,document.getElementById("app-header").innerHTML=je.a,document.getElementById("app-body").innerHTML=_e.a,Te("Санкт-Петербург"),xe(),ne(),e.next=9,fetch("".concat("https://weather-app-222.herokuapp.com","/favorite")).then((function(e){return e.json()}));case 9:n=e.sent,ce(null==n||null===(t=n.data)||void 0===t?void 0:t.map((function(e){return null==e?void 0:e.name})));case 12:ke(),window.addEventListener("storageChanged",Oe);case 14:case"end":return e.stop()}}),e)})));n(49)}]);
