!function(e){function t(t){for(var a,c,o=t[0],d=t[1],s=t[2],l=0,f=[];l<o.length;l++)c=o[l],Object.prototype.hasOwnProperty.call(r,c)&&r[c]&&f.push(r[c][0]),r[c]=0;for(a in d)Object.prototype.hasOwnProperty.call(d,a)&&(e[a]=d[a]);for(u&&u(t);f.length;)f.shift()();return i.push.apply(i,s||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],a=!0,o=1;o<n.length;o++){var d=n[o];0!==r[d]&&(a=!1)}a&&(i.splice(t--,1),e=c(c.s=n[0]))}return e}var a={},r={0:0},i=[];function c(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=a,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)c.d(n,a,function(t){return e[t]}.bind(null,a));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/";var o=window.webpackJsonp=window.webpackJsonp||[],d=o.push.bind(o);o.push=t,o=o.slice();for(var s=0;s<o.length;s++)t(o[s]);var u=d;i.push([32,1]),n()}([,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return d}));var a,r=n(1),i=n.n(r),c={Update:"Update",Clouds:"Clouds",Drizzle:"Drizzle",Snow:"Snow",Thunderstorm:"Thunderstorm",Rain:"Rain",Clear:"Clear",Tornado:"Tornado",Mist:"Mist",Smoke:"Smoke",Haze:"Haze",Dust:"Dust",Fog:"Fog",Sand:"Sand",Ash:"Ash",Squall:"Squall"},o="./assets/img/017-foog.svg",d=(a={},i()(a,c.Update,"./assets/img/update-arrows.svg"),i()(a,c.Clouds,"./assets/img/001-cloud.svg"),i()(a,c.Drizzle,"./assets/img/003-rainy.svg"),i()(a,c.Thunderstorm,"./assets/img/036-storm-4.svg"),i()(a,c.Snow,"./assets/img/012-snowy-1.svg"),i()(a,c.Rain,"./assets/img/004-rainy-1.svg"),i()(a,c.Clear,"./assets/img/039-sun.svg"),i()(a,c.Tornado,"./assets/img/046-tornado.svg"),i()(a,c.Mist,o),i()(a,c.Smoke,o),i()(a,c.Haze,o),i()(a,c.Dust,o),i()(a,c.Fog,o),i()(a,c.Sand,o),i()(a,c.Ash,o),i()(a,c.Squall,o),a)},function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return u})),n.d(t,"d",(function(){return l}));var a=n(16),r=n.n(a),i=window.localStorage;function c(){i.setItem("app-cities-data",JSON.stringify([]))}function o(){return JSON.parse(i.getItem("app-cities-data"))||c(),JSON.parse(i.getItem("app-cities-data"))}function d(e){i.setItem("app-cities-data",JSON.stringify(e))}function s(e){if(e){var t=o();if(t.includes(e))throw Error("Город уже добавлен в избранное");t.push(e),d(t),window.dispatchEvent(new Event("storageChanged"))}}function u(e){var t=o();i.setItem("app-cities-data",JSON.stringify([].concat(r()(t),r()(e))))}function l(e){e&&(d(o().filter((function(t){return t!==e}))),window.dispatchEvent(new Event("storageChanged")))}},function(e,t,n){"use strict";n.d(t,"b",(function(){return M})),n.d(t,"d",(function(){return L})),n.d(t,"c",(function(){return F})),n.d(t,"a",(function(){return U}));var a=n(3),r=n.n(a),i=n(0),c=n.n(i),o=n(13),d=n(27),s=n.n(d);function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.data,n=t.coord,a=t.name,r=t.main,i=(r=void 0===r?{}:r).temp,c=r.humidity,o=r.pressure,d=t.clouds,u=(d=void 0===d?{}:d).all,l=t.wind,f=t.weather,p="[".concat(n.lat.toFixed(2),", ").concat(n.lon.toFixed(2),"]"),v="".concat(u,"%"),h="".concat(l.speed," m/s, ").concat(l.deg),m="".concat(o," hpa"),g="".concat(c,"%"),y=s()(f,1),b=y[0].main,w=Math.floor(i),_=[{title:"Ветер",value:h},{title:"Облачность",value:v},{title:"Давление",value:m},{title:"Влажность",value:g},{title:"Координаты",value:p}];return{weatherDetails:_,city:a,degree:w,weatherType:b}}var l=n(9),f=n(4),p=(n(46),n(28)),v=n.n(p),h=(n(48),n(29)),m=n.n(h),g=n(12),y=n(7),b=n(5),w=n(8),_="".concat("city-card-header","-city"),x="".concat("city-card-header","-degree"),E="".concat("city-card-header","-icon"),O="".concat("city-card-header","-close");var j=n(11),I=(n(55),n(31)),T=n.n(I);function C(e,t){var n=t.isLoading,a=t.weatherDetails,i=t.weatherType,o=t.city,d=t.degree;if(!e)return null;var s=(new DOMParser).parseFromString(v.a,"text/html"),u=s.getElementById("city-card"),l=s.getElementById("city-card-data");if(u.id+="-".concat(e),l.id+="-".concat(e),n){var p=function(e){var t=(new DOMParser).parseFromString(T.a,"text/html"),n=null==t?void 0:t.getElementById("card-loading"),a=null==t?void 0:t.getElementById("card-loading-icon-container");n.id="".concat("card-loading","-").concat(e),a.id="".concat("card-loading-icon-container","-").concat(e);var r=Object(y.a)("card-loading-".concat(e),f.b.Update);return a.appendChild(r),n}(e);l.appendChild(p)}else{var h=Object(j.a)(e,a);l.appendChild(h)}var I=s.getElementById("city-card-header"),C=function(e,t){var n=t.weatherType,a=t.city,i=t.degree,o=(new DOMParser).parseFromString(m.a,"text/html"),d=o.getElementById("city-card-header"),s=o.getElementById(_),u=o.getElementById(x),l=o.getElementById(E),f=o.getElementById(O),p=Object(y.a)(e,n);p&&l.appendChild(p);var v=Object(g.a)("✕"),h="".concat(e).replace("city-card-","");return h&&(v.onclick=r()(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(w.a)(h);case 2:Object(b.d)(h);case 3:case"end":return e.stop()}}),e)})))),f.appendChild(v),a&&(s.innerText=a),i&&(u.innerText="".concat(i,"°C")),d.id="".concat("city-card-header","-").concat(e),s.id="".concat(_,"-").concat(e),u.id="".concat(x,"-").concat(e),l.id="".concat(E,"-").concat(e),f.id="".concat(O,"-").concat(e),d}(e,{weatherType:i,city:o,degree:d});return I.appendChild(C),u}var S=n(10);function M(e){return B.apply(this,arguments)}function B(){return(B=r()(c.a.mark((function e(t){var n,a,r,i,o,d;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),a=new FormData(t.target),!(r=a.get("city"))){e.next=21;break}return e.prev=4,e.next=7,Object(w.c)(r);case 7:if("city not found"!==(null==(o=e.sent)?void 0:o.message)){e.next=10;break}throw new Error("Город с таким названием не найден");case 10:if(!(null==o||null===(i=o.message)||void 0===i?void 0:i.includes("already exists"))){e.next=12;break}throw new Error("Город уже добавлен");case 12:if(!(null==o?void 0:o.data)){e.next=16;break}return e.next=15,D(o);case 15:Object(b.b)(null===(d=o.data)||void 0===d?void 0:d.name);case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(4),alert(e.t0.message||"Город уже добавлен в избранное");case 21:null==t||null===(n=t.target)||void 0===n||n.reset();case 22:case"end":return e.stop()}}),e,null,[[4,18]])})))).apply(this,arguments)}function k(){Object(l.b)({weatherType:f.b.Update,city:"Подождите, данные загружаются"})}function L(e){return P.apply(this,arguments)}function P(){return(P=r()(c.a.mark((function e(t){var n,a,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,k(),e.next=4,Object(o.b)();case 4:(n=e.sent)&&(a=u(n),setTimeout((function(){return Object(l.b)(a)}),500)),e.next=17;break;case 8:if(e.prev=8,e.t0=e.catch(0),console.log(e.t0),alert("Пожалуйста, разрешите доступ к геолокации"),!t){e.next=17;break}return e.next=15,Object(o.a)(t);case 15:(n=e.sent)&&(r=u(n),setTimeout((function(){return Object(l.b)(r)}),500));case 17:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function D(e){return A.apply(this,arguments)}function A(){return(A=r()(c.a.mark((function e(t){var n,a,r,i,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=document.getElementById(S.b),a=u(t),r=a.city,i=C(r,{isLoading:!0,city:r}),n.appendChild(i);try{o=C(r,a),n.removeChild(i),n.appendChild(o)}catch(e){console.log(e),alert("Произошла ошибка при добавлении города."),n.removeChild(i)}case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(){var e=Object(b.e)(),t=document.getElementById(S.b);t.childNodes.forEach((function(n){if(n.id){var a="".concat(n.id).replace("city-card-","");e.includes(a)||t.removeChild(n)}})),e.forEach((function(e){document.getElementById("city-card-".concat(e))||Object(o.a)(e).then((function(e){return e&&D(e)}))}))}function U(){F()}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(4);function r(e,t){var n=a.a[t];if(!n)return null;var r=document.createElement("div");r.id="weather-icon-container-".concat(e),r.classList.add("weather-icon__container");var i=document.createElement("img");return i.id="weather-icon-".concat(e),i.classList.add("weather-icon__icon"),i.src=n,r.appendChild(i),r}},function(e,t,n){"use strict";(function(e){function a(){return fetch("".concat(e.env.API_URL,"/favorite")).then((function(e){return e.json()}))}function r(t){return fetch("".concat(e.env.API_URL,"/favorite"),{method:"POST",body:JSON.stringify({name:t}),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()}))}function i(t){return fetch("".concat(e.env.API_URL,"/favorite"),{method:"DELETE",body:JSON.stringify({name:t}),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()}))}n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}))}).call(this,n(15))},function(e,t,n){"use strict";n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return v.a}));var a=n(26),r=n.n(a),i=(n(17),n(37),n(18)),c=n.n(i),o=(n(39),n(7)),d=n(4),s=n(19),u=n.n(s);var l=n(11),f=n(6),p=n(24),v=n.n(p);function h(e){var t=e.weatherDetails,n=r()(e,["weatherDetails"]),a=document.getElementById("update-geolocation-button"),i=document.getElementById("header-menu-top");a&&(i.insertAdjacentHTML("beforeend",c.a),a.onclick=f.d),document.getElementById("header-menu-weather-main").innerHTML=u.a,function(e){var t=e.weatherType,n=e.degree,a=e.city,r=void 0===a?"":a,i=document.getElementById("weather-main-container"),c=document.getElementById("weather-main-icon"),s=document.getElementById("weather-main-degree"),u=document.getElementById("weather-main-city");t===d.b.Update&&i.classList.add("updating");var l=Object(o.a)("header-menu",t);l&&c.appendChild(l),s.innerText=n&&"".concat(n,"°")||"",u.innerText=r}(n);var s=Object(l.a)("header-menu",t);s&&document.getElementById("header-menu-weather-detailed").replaceChildren(s)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return d.a})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return u}));n(57),n(59);var a=n(12),r=n(6),i=n(22),c=n.n(i);var o=n(23),d=n.n(o),s="favorite-cities-cities";function u(){document.getElementById("favorite-cities-add").innerHTML=c.a,function(){var e=document.getElementById("add-city-input-container").querySelector("form");e.onsubmit=r.b;var t=Object(a.a)("+");t.type="submit",e.appendChild(t)}()}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));n(41);function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=document.createElement("ul");return 0!==t.length&&e?(n.id="".concat("weather-detailed","-").concat(e),n.classList.add("weather-detailed"),t.forEach((function(e){var t=e.title,a=e.value,r=document.createElement("li"),i=document.createElement("span"),c=document.createElement("span");r.classList.add("weather-detailed__item"),i.classList.add("weather-detailed__title"),i.innerText=t,c.innerText=a,r.appendChild(i),r.appendChild(c),n.appendChild(r)})),n):null}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(30),r=n.n(a);n(50);function i(e){var t=(new DOMParser).parseFromString(r.a,"text/html"),n=null==t?void 0:t.getElementsByTagName("button")[0];return n.innerText=e,n}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return f}));var a=n(3),r=n.n(a),i=n(0),c=n.n(i),o=navigator.geolocation;function d(){return new Promise((function(e,t){o.getCurrentPosition((function(t){var n=t.coords,a=n.latitude,r=n.longitude;e({latitude:a,longitude:r})}),(function(e){console.error(e),t(e)}),{enableHighAccuracy:!0})}))}function s(t,n){return fetch("".concat(e.env.API_URL,"/weather/coordinates?lat=").concat(t,"&lon=").concat(n)).then((function(e){return e.json()})).catch((function(e){console.log(e),alert("Ошибка во время выполнения запроса ".concat(e))}))}function u(e){return l.apply(this,arguments)}function l(){return(l=r()(c.a.mark((function t(n){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",fetch("".concat(e.env.API_URL,"/weather/city?name=").concat(decodeURI(n))).then((function(e){return e.json()})).catch((function(e){console.log(e),alert("Ошибка во время выполнения запроса ".concat(e))})));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function f(){return p.apply(this,arguments)}function p(){return(p=r()(c.a.mark((function e(){var t,n,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d();case 3:a=e.sent,t=a.latitude,n=a.longitude,e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(0),new Error("Cant get geolocation");case 11:return e.next=13,s(t,n);case 13:return e.abrupt("return",e.sent);case 14:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}}).call(this,n(15))},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return c}));n(61);var a=n(25),r=n.n(a);n.d(t,"a",(function(){return r.a}));var i="app-header",c="app-body"},,,function(e,t,n){var a=n(2),r=n(36);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};a(r,i);e.exports=r.locals||{}},function(e,t){e.exports='<div class="update-button"> <button id="update-geolocation-button" class="update-button__button"> <span class="update-button__button-text">Обновить геолокацию</span> <img class="update-button__button-icon" src="./assets/img/update-arrows.svg" alt="update icon"/> </button> </div> '},function(e,t){e.exports='<div id="weather-main-container" class="weather-main"> <div class="weather-main__city"><h2 id="weather-main-city"></h2></div> <div id="weather-main-icon" class="weather-main__icon"> </div> <div id="weather-main-degree" class="weather-main__degree"></div> </div> '},,,function(e,t){e.exports='<div class="add-city"> <div class="add-city__header"> <h3>Избранное</h3> </div> <div id="add-city-input-container" class="add-city__input"> <form> <input name="city" placeholder="Добавить новый город" type="text"> </form> </div> </div> '},function(e,t){e.exports='<div class="favorite-cities"> <div id="favorite-cities-add" class="favorite-cities__add"></div> <div id="favorite-cities-cities" class="favorite-cities__cities"></div> </div> '},function(e,t){e.exports='<div id="header-menu-container" class="header-menu"> <div class="header-menu__top" id="header-menu-top"> <div class="header-menu__top-title"><h1>Погода здесь</h1></div> </div> <div id="header-menu-weather" class="header-menu-weather"> <div class="header-menu-weather__main" id="header-menu-weather-main"></div> <div class="header-menu-weather__detailed" id="header-menu-weather-detailed"></div> </div> </div> '},function(e,t){e.exports='<main class="app"> <div class="app-container"> <header class="app-header" id="app-header"></header> <div class="app-body" id="app-body"></div> </div> </main> '},,,function(e,t){e.exports='<div id="city-card" class="city-card"> <div id="city-card-header" class="city-card__header"></div> <div id="city-card-data" class="city-card__data"></div> </div> '},function(e,t){e.exports='<div id="city-card-header" class="city-card-header"> <div class="city-card-header__first-part"> <div id="city-card-header-city" class="city-card-header__header"></div> <div id="city-card-header-degree" class="city-card-header__degree"></div> <div id="city-card-header-icon" class="city-card-header__icon"></div> </div> <div class="city-card-header__second-part"> <div id="city-card-header-close" class="city-card-header__close"></div> </div> </div> '},function(e,t){e.exports='<div> <button class="round-button"></button> </div> '},function(e,t){e.exports='<div id="card-loading" class="card-loading"> <div><p>Подождите, данные загружаются</p></div> <div id="card-loading-icon-container" class="card-loading__icon"></div> </div> '},function(e,t,n){"use strict";n.r(t);n(33),n(63)},function(e,t,n){"use strict";(function(e){var t=n(3),a=n.n(t),r=n(0),i=n.n(r),c=n(9),o=n(10),d=n(14),s=(n(17),n(6)),u=n(8),l=n(5);window.onload=a()(i.a.mark((function t(){var n,a,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(document.getElementById("root").innerHTML=d.a,document.getElementById(d.c).innerHTML=c.a,document.getElementById(d.b).innerHTML=o.a,Object(s.d)("Санкт-Петербург"),Object(o.c)(),!e.env.FAVORITES_FROM_BACKEND){t.next=12;break}return Object(l.c)(),t.next=9,Object(u.b)();case 9:a=t.sent,r=null==a||null===(n=a.data)||void 0===n?void 0:n.map((function(e){return null==e?void 0:e.name})),Object(l.a)(r);case 12:Object(s.c)(),window.addEventListener("storageChanged",s.a);case 14:case"end":return t.stop()}}),t)})))}).call(this,n(15))},,,function(e,t,n){},function(e,t,n){var a=n(2),r=n(38);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};a(r,i);e.exports=r.locals||{}},function(e,t,n){},function(e,t,n){var a=n(2),r=n(40);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};a(r,i);e.exports=r.locals||{}},function(e,t,n){},function(e,t,n){var a=n(2),r=n(42);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};a(r,i);e.exports=r.locals||{}},function(e,t,n){},,,,function(e,t,n){var a=n(2),r=n(47);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};a(r,i);e.exports=r.locals||{}},function(e,t,n){},function(e,t,n){var a=n(2),r=n(49);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};a(r,i);e.exports=r.locals||{}},function(e,t,n){},function(e,t,n){var a=n(2),r=n(51);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};a(r,i);e.exports=r.locals||{}},function(e,t,n){},,,,function(e,t,n){var a=n(2),r=n(56);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};a(r,i);e.exports=r.locals||{}},function(e,t,n){},function(e,t,n){var a=n(2),r=n(58);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};a(r,i);e.exports=r.locals||{}},function(e,t,n){},function(e,t,n){var a=n(2),r=n(60);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};a(r,i);e.exports=r.locals||{}},function(e,t,n){},function(e,t,n){var a=n(2),r=n(62);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};a(r,i);e.exports=r.locals||{}},function(e,t,n){},function(e,t,n){var a=n(2),r=n(64);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};a(r,i);e.exports=r.locals||{}},function(e,t,n){}]);
